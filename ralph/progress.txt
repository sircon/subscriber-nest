# Ralph Progress Log
Started: Mon Jan 19 09:42:21 CET 2026

## Codebase Patterns
- ESP connectors are in `apps/backend/libs/core/src/esp/` and implement `IEspConnector` interface
- EspType enum is defined in `apps/backend/libs/database/src/entities/esp-connection.entity.ts`
- Migrations are in `apps/backend/apps/api/src/migrations/` and use TypeORM's MigrationInterface
- PostgreSQL enums use `ALTER TYPE ... ADD VALUE IF NOT EXISTS` for adding new values (cannot remove values)
- Backend lint command has a pre-existing ESLint config issue (glob patterns ignoring all files)
- Existing connectors use HttpService from @nestjs/axios with firstValueFrom() from rxjs for API calls
- ESP auth varies: Basic Auth (Campaign Monitor), API key in query params (Email Octopus), Bearer token, etc.

---

## Mon Jan 19, 2026 - US-001
- **What was implemented**: Added 14 new ESP types to the EspType enum and created database migration
- **Files changed**:
  - `apps/backend/libs/database/src/entities/esp-connection.entity.ts` - Added 14 new enum values
  - `apps/backend/apps/api/src/migrations/1768745000000-AddNewEspTypes.ts` - Migration to add enum values to PostgreSQL
- **Learnings for future iterations:**
  - PostgreSQL enums cannot have values removed, only added - use `ADD VALUE IF NOT EXISTS`
  - Existing ESP types use snake_case format (e.g., 'campaign_monitor', not 'campaignMonitor')
  - The backend lint command fails due to ESLint config issue, but build passes
- Campaign Monitor uses Basic Auth with API key as username and empty password
- Campaign Monitor organizes lists under clients - need to iterate clients first, then get lists per client
---

## Mon Jan 19, 2026 - US-002
- **What was implemented**: Created Campaign Monitor ESP connector
- **Files changed**:
  - `apps/backend/libs/core/src/esp/campaign-monitor.connector.ts` - New connector implementing IEspConnector interface
- **Learnings for future iterations:**
  - Campaign Monitor uses Basic Auth (API key as username, empty password) - use `Buffer.from(apiKey + ':').toString('base64')`
  - API base URL is `https://api.createsend.com/api/v3.2`
  - Publications = clients' subscriber lists; need to fetch /clients.json then /clients/{id}/lists.json for each
  - Active subscribers at /lists/{listId}/active.json, unsubscribed at /lists/{listId}/unsubscribed.json
  - List stats (including subscriber count) available at /lists/{listId}/stats.json
  - Campaign Monitor supports up to 1000 records per page
---

## Mon Jan 19, 2026 - US-003
- **What was implemented**: Created Email Octopus ESP connector
- **Files changed**:
  - `apps/backend/libs/core/src/esp/email-octopus.connector.ts` - New connector implementing IEspConnector interface
- **Learnings for future iterations:**
  - Email Octopus uses API key authentication via query parameter (`api_key`)
  - API base URL is `https://emailoctopus.com/api/1.6`
  - Lists endpoint: GET /lists, List details: GET /lists/{listId}, Contacts: GET /lists/{listId}/contacts
  - Pagination uses `paging.next` to check for more pages, default limit is 100
  - Subscriber counts available in list details via `counts.subscribed`
  - Status values: SUBSCRIBED, UNSUBSCRIBED, PENDING, BOUNCED
  - Custom fields stored in `fields` object (FirstName, LastName, etc.)
---
