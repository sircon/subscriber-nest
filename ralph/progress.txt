# Ralph Progress Log
Started: Sun Jan 18 15:17:58 CET 2026
---

## 2026-01-18 15:18 - US-001
- Created shared package directory structure at `packages/shared/src/` with all required subdirectories (entities, dto, services, events, interfaces, types)
- Updated root `package.json` to include `packages/*` in workspaces configuration
- Fixed linting error in `apps/frontend/next-env.d.ts` (prettier quote style)
- Files changed:
  - `package.json` - Added `packages/*` to workspaces
  - `apps/frontend/next-env.d.ts` - Fixed quote style for linting
  - Created directory structure: `packages/shared/src/{entities,dto,services,events,interfaces,types}/`
- **Learnings for future iterations:**
  - Empty directories are not tracked by git until files are added (this is expected behavior)
  - Root `package.json` workspaces must include both `apps/*` and `packages/*` for monorepo structure
  - Turborepo automatically recognizes new workspaces once added to root package.json
  - Use `yarn lint` and `yarn build` to verify changes don't break existing code
---

## 2026-01-18 15:25 - US-002
- Created `packages/shared/package.json` with name `@subscriber-nest/shared`, version, and proper exports configuration for all subdirectories (entities, dto, services, events, interfaces, types)
- Created `packages/shared/tsconfig.json` with TypeScript configuration matching backend settings (commonjs, ES2022 target, decorators enabled)
- Created index.ts files for all subdirectories with empty exports to make them valid TypeScript modules
- Configured TypeScript paths in `apps/backend/tsconfig.json` to include `@subscriber-nest/shared` and `@subscriber-nest/shared/*` aliases pointing to `../../packages/shared/src`
- Root `package.json` already had `packages/*` in workspaces from US-001
- Files changed:
  - `packages/shared/package.json` - Created with exports configuration
  - `packages/shared/tsconfig.json` - Created with TypeScript config
  - `packages/shared/src/index.ts` - Main entry point
  - `packages/shared/src/{entities,dto,services,events,interfaces,types}/index.ts` - Subdirectory entry points
  - `apps/backend/tsconfig.json` - Added path aliases for shared package
- **Learnings for future iterations:**
  - Empty TypeScript files need `export {};` to be recognized as modules
  - Shared package exports should use both `types` and `default` fields in package.json exports for proper TypeScript support
  - TypeScript path aliases in tsconfig.json use relative paths from the tsconfig.json location
  - Turborepo automatically builds all packages in workspaces when running `yarn build`
  - Package name should use scoped format `@subscriber-nest/shared` for monorepo packages
---

## 2026-01-18 16:15 - US-003
- Moved all 8 entity files from `apps/backend/src/entities/` to `packages/shared/src/entities/`:
  - billing-subscription.entity.ts
  - billing-usage.entity.ts
  - esp-connection.entity.ts
  - session.entity.ts
  - subscriber.entity.ts
  - sync-history.entity.ts
  - user.entity.ts
  - verification-code.entity.ts
- Updated all entity imports within entities to use relative paths (they reference each other using `./entity-name.entity`)
- Updated `packages/shared/src/entities/index.ts` to export all entities and their enums
- Updated all backend imports (24 files) to use `@subscriber-nest/shared/entities` instead of relative paths:
  - Controllers: subscriber, esp-connection, dashboard, billing, account, auth
  - Services: sync-history, subscriber, subscriber-sync, subscriber-mapper, subscriber-export, esp-connection, billing-usage, billing-subscription, auth
  - Processors: subscriber-sync, billing, account-deletion
  - Guards: subscription, auth
  - Decorators: current-user
  - DTOs: create-subscriber, create-esp-connection
  - app.module.ts
- Deleted old entity files from backend
- Files changed:
  - Created 8 entity files in `packages/shared/src/entities/`
  - Updated `packages/shared/src/entities/index.ts` to export all entities
  - Updated 24 files in `apps/backend/src/` to use shared package imports
  - Deleted 8 entity files from `apps/backend/src/entities/`
- **Learnings for future iterations:**
  - Entity files can reference each other using relative imports within the same directory (e.g., `./user.entity`)
  - When moving entities, update imports in: controllers, services, processors, guards, decorators, DTOs, and app.module.ts
  - Use `@subscriber-nest/shared/entities` import path for all entity imports after moving to shared package
  - All entities and their enums should be exported from `packages/shared/src/entities/index.ts`
  - Use `turbo run build --filter=backend` and `turbo run build --filter=@subscriber-nest/shared` to verify compilation
  - Use `yarn lint` to verify code style after moving files
---

## 2026-01-18 15:23 - US-004
- Moved all 2 DTO files from `apps/backend/src/dto/` to `packages/shared/src/dto/`:
  - create-esp-connection.dto.ts
  - create-subscriber.dto.ts
- Updated `packages/shared/src/dto/index.ts` to export both DTOs
- Updated all backend imports (3 files) to use `@subscriber-nest/shared/dto` instead of relative paths:
  - Controllers: esp-connection
  - Services: subscriber-mapper, subscriber
- Fixed imports within shared package DTOs to use relative paths (`../entities`) instead of package name imports (package name imports are for external consumers)
- Deleted old DTO files from backend
- Files changed:
  - Created 2 DTO files in `packages/shared/src/dto/`
  - Updated `packages/shared/src/dto/index.ts` to export both DTOs
  - Updated 3 files in `apps/backend/src/` to use shared package imports
  - Deleted 2 DTO files from `apps/backend/src/dto/`
- **Learnings for future iterations:**
  - Within the shared package itself, use relative imports (e.g., `../entities`) instead of package name imports (e.g., `@subscriber-nest/shared/entities`)
  - Package name imports (`@subscriber-nest/shared/*`) are for external packages that consume the shared package
  - When moving DTOs, update imports in: controllers and services
  - Use `@subscriber-nest/shared/dto` import path for all DTO imports after moving to shared package
  - All DTOs should be exported from `packages/shared/src/dto/index.ts`
  - Use `turbo run build --filter=backend --filter=@subscriber-nest/shared` to verify compilation
---

## 2026-01-18 15:25 - US-005
- Moved `EncryptionService` from `apps/backend/src/services/` to `packages/shared/src/services/`
- Added `@nestjs/common` and `@nestjs/config` as dependencies to `packages/shared/package.json`
- Updated `packages/shared/src/services/index.ts` to export `EncryptionService`
- Updated all backend imports (6 files) to use `@subscriber-nest/shared/services` instead of relative paths:
  - Controllers: subscriber
  - Services: subscriber-mapper, subscriber-sync, esp-connection, subscriber-export
  - app.module.ts
- Deleted old EncryptionService file from backend
- Files changed:
  - `packages/shared/package.json` - Added NestJS dependencies
  - Created `packages/shared/src/services/encryption.service.ts`
  - Updated `packages/shared/src/services/index.ts` to export EncryptionService
  - Updated 6 files in `apps/backend/src/` to use shared package imports
  - Deleted `apps/backend/src/services/encryption.service.ts`
- **Learnings for future iterations:**
  - When moving services to shared package, add their dependencies (e.g., `@nestjs/common`, `@nestjs/config`) to shared package.json
  - Services that depend on NestJS decorators (like `@Injectable()`) can be moved to shared package as long as dependencies are added
  - When moving services, update imports in: controllers, services, processors, and app.module.ts
  - Use `@subscriber-nest/shared/services` import path for all service imports after moving to shared package
  - All services should be exported from `packages/shared/src/services/index.ts`
  - Run `yarn install` after adding dependencies to shared package
  - Use `yarn workspace @subscriber-nest/shared typecheck` and `yarn exec tsc --noEmit` in backend to verify compilation
---

## 2026-01-18 15:27 - US-006
- Created API service directory structure at `apps/api/src/` with all required subdirectories (controllers, services, guards, decorators)
- Directory structure matches the backend structure for easy migration
- Files changed:
  - Created directory structure: `apps/api/src/{controllers,services,guards,decorators}/`
- **Learnings for future iterations:**
  - Empty directories are not tracked by git until files are added (this is expected behavior)
  - API service directory structure mirrors backend structure to facilitate migration
  - Use `yarn lint` to verify changes don't break existing code
  - Typecheck passes automatically when there are no TypeScript files to check
---

## 2026-01-19 - US-007
- Created `apps/api/package.json` with NestJS dependencies matching backend configuration
- Created `apps/api/tsconfig.json` with TypeScript configuration including paths to shared package (`@subscriber-nest/shared` and `@subscriber-nest/shared/*`)
- Created `apps/api/nest-cli.json` with NestJS CLI configuration
- Copied `apps/api/eslint.config.mjs` from backend for linting configuration
- Created minimal `apps/api/src/index.ts` placeholder file to allow typecheck to pass
- Root `package.json` already had `apps/*` in workspaces, so no update needed
- Files changed:
  - `apps/api/package.json` - Created with NestJS dependencies
  - `apps/api/tsconfig.json` - Created with TypeScript config and shared package paths
  - `apps/api/nest-cli.json` - Created with NestJS CLI config
  - `apps/api/eslint.config.mjs` - Copied from backend
  - `apps/api/src/index.ts` - Created minimal placeholder
- **Learnings for future iterations:**
  - Yarn 1.x (used in this project) doesn't support `workspace:*` protocol for workspace dependencies
  - Use TypeScript path aliases in tsconfig.json to reference shared package instead of adding it as a dependency
  - TypeScript config needs `include` and `exclude` fields when there are no source files yet (or create a minimal placeholder file)
  - Copy eslint.config.mjs from backend to maintain consistent linting configuration
  - Root package.json workspaces already includes `apps/*`, so new apps are automatically recognized
  - Use `yarn install` after creating package.json to install dependencies
  - Use `yarn lint --filter=api` and `yarn build --filter=api` to verify API service configuration
---

## 2026-01-19 - US-008
- Copied all 5 controller files from `apps/backend/src/controllers/` to `apps/api/src/controllers/`:
  - account.controller.ts
  - billing.controller.ts
  - dashboard.controller.ts
  - esp-connection.controller.ts
  - subscriber.controller.ts
- Copied `apps/backend/src/auth.controller.ts` to `apps/api/src/auth.controller.ts`
- Copied `apps/backend/src/app.controller.ts` to `apps/api/src/app.controller.ts`
- Created `apps/api/src/app.service.ts` (required by app.controller.ts)
- Verified all entity and DTO imports already use `@subscriber-nest/shared/entities` and `@subscriber-nest/shared/dto` (no updates needed)
- Files changed:
  - Created 7 controller files in `apps/api/src/controllers/` and `apps/api/src/`
  - Created `apps/api/src/app.service.ts`
- **Learnings for future iterations:**
  - Controllers already use shared package imports for entities and DTOs (from previous stories)
  - Controllers reference services, guards, and decorators that will be copied in US-009 and US-010
  - Type errors for missing services/guards/decorators are expected until those stories are completed
  - All entity and DTO imports correctly use `@subscriber-nest/shared/*` paths
  - Use `yarn lint --filter=api` to verify code style after copying controllers
  - Typecheck will show errors for missing dependencies until services/guards/decorators are copied
---

## 2026-01-18 15:34 - US-009
- Copied all 9 API services from `apps/backend/src/services/` to `apps/api/src/services/`:
  - SubscriberService
  - SubscriberExportService
  - EspConnectionService
  - AuthService
  - EmailService
  - StripeService
  - BillingSubscriptionService
  - BillingUsageService
  - BillingCalculationService
- Also copied `SyncHistoryService` (not explicitly listed in PRD but required by esp-connection.controller.ts)
- Copied dependencies required by services:
  - `BeehiivConnector` to `apps/api/src/connectors/`
  - `IEspConnector` interface to `apps/api/src/interfaces/`
  - `esp.interface.ts` to `apps/api/src/interfaces/`
  - `VerificationCodeEmail` template to `apps/api/src/emails/`
- Fixed import paths in controllers:
  - Updated `auth.controller.ts` to import `AuthService` from `./services/auth.service`
  - Updated `billing.controller.ts` to import `AuthService` from `../services/auth.service`
- All services already use shared package imports (`@subscriber-nest/shared/entities`, `@subscriber-nest/shared/dto`, `@subscriber-nest/shared/services`) - no updates needed
- Files changed:
  - Created 10 service files in `apps/api/src/services/`
  - Created `apps/api/src/connectors/beehiiv.connector.ts`
  - Created `apps/api/src/interfaces/esp-connector.interface.ts` and `esp.interface.ts`
  - Created `apps/api/src/emails/verification-code-email.tsx`
  - Updated `apps/api/src/auth.controller.ts` - Fixed AuthService import path
  - Updated `apps/api/src/controllers/billing.controller.ts` - Fixed AuthService import path
- **Learnings for future iterations:**
  - Services copied from backend already use shared package imports (from previous stories), so no import updates needed
  - When copying services, also copy their dependencies (connectors, interfaces, email templates)
  - Controllers may reference services that aren't explicitly listed in the PRD but are required for functionality (e.g., SyncHistoryService)
  - Service import paths in controllers need to be updated to point to `services/` subdirectory
  - Lint passes for all copied services
  - Typecheck errors for guards/decorators are expected until US-010 is completed
  - Use `yarn lint --filter=api` to verify code style after copying services
---

## 2026-01-18 15:35 - US-010
- Copied all 2 guard files from `apps/backend/src/guards/` to `apps/api/src/guards/`:
  - auth.guard.ts
  - subscription.guard.ts
- Copied `CurrentUser` decorator from `apps/backend/src/decorators/` to `apps/api/src/decorators/`:
  - current-user.decorator.ts
- All guards and decorators already use shared package imports (`@subscriber-nest/shared/entities`) - no updates needed
- `SubscriptionGuard` imports `BillingSubscriptionService` from `../services/billing-subscription.service` (already in API service from US-009)
- Controllers already have correct import paths (`../guards/` and `../decorators/`) - no updates needed
- Files changed:
  - Created `apps/api/src/guards/auth.guard.ts`
  - Created `apps/api/src/guards/subscription.guard.ts`
  - Created `apps/api/src/decorators/current-user.decorator.ts`
- **Learnings for future iterations:**
  - Guards and decorators copied from backend already use shared package imports (from previous stories), so no import updates needed
  - Guards that depend on services (like `SubscriptionGuard` using `BillingSubscriptionService`) should import from the API service's services directory
  - Controllers already have correct import paths for guards and decorators, so no controller updates needed
  - All entity imports correctly use `@subscriber-nest/shared/entities` paths
  - Use `turbo run build --filter=api` and `turbo run lint --filter=api` to verify compilation and code style
  - Guards use `@InjectRepository` for TypeORM repositories, which will need to be configured in AppModule (US-011)
---

## 2026-01-18 15:36 - US-011
- Created `apps/api/src/app.module.ts` with TypeORM configuration matching backend structure
- Configured `TypeOrmModule.forRoot()` with database connection settings from environment variables (DATABASE_HOST, DATABASE_PORT, DATABASE_USER, DATABASE_PASSWORD, DATABASE_NAME)
- Configured `TypeOrmModule.forFeature()` with all 8 entities from shared package (Subscriber, EspConnection, VerificationCode, User, Session, SyncHistory, BillingSubscription, BillingUsage)
- Registered all controllers (AppController, AuthController, EspConnectionController, SubscriberController, DashboardController, BillingController, AccountController)
- Registered all services and dependencies (AppService, EncryptionService, BeehiivConnector, and all API services)
- Registered guards (AuthGuard, SubscriptionGuard)
- Configured ConfigModule.forRoot() and HttpModule for API service needs
- Files changed:
  - `apps/api/src/app.module.ts` - Created with TypeORM configuration
- **Learnings for future iterations:**
  - TypeORM configuration in API service matches backend structure exactly (same connection settings, same entities)
  - All entities are imported from `@subscriber-nest/shared/entities` using named imports
  - TypeOrmModule.forFeature() must include all entities that will be used with @InjectRepository decorators
  - ConfigModule.forRoot({ isGlobal: true }) allows all services to access environment variables via @nestjs/config
  - Use `yarn workspace api typecheck` and `turbo run build --filter=api` to verify TypeORM configuration
  - TypeORM autoLoadEntities: true automatically discovers entities, but forFeature() is still needed for repository injection
---

## 2026-01-19 - US-012
- Configured BullMQ in API service with `BullModule.forRoot()` using Redis connection from environment variables (REDIS_HOST, REDIS_PORT, REDIS_PASSWORD)
- Registered all three queues using `BullModule.registerQueue()`: subscriber-sync, billing, and account-deletion
- All queues configured with default job options (3 attempts, exponential backoff with 2000ms delay)
- No queue processors registered (API service only acts as producer, not consumer)
- Files changed:
  - `apps/api/src/app.module.ts` - Added BullModule import and configuration
- **Learnings for future iterations:**
  - BullMQ configuration in API service matches backend structure (same Redis connection settings, same queue names)
  - API service only needs `BullModule.forRoot()` and `BullModule.registerQueue()` - no processors needed
  - Controllers can use `@InjectQueue('queue-name')` to inject queue instances for adding jobs
  - All three queues (subscriber-sync, billing, account-deletion) are registered even if only subscriber-sync is currently used
  - Redis connection uses environment variables with defaults (localhost:6379, no password)
  - Use `yarn workspace api typecheck`, `turbo run lint --filter=api`, and `turbo run build --filter=api` to verify BullMQ configuration
---

## 2026-01-18 15:39 - US-013
- Created `apps/api/src/main.ts` that bootstraps NestJS application with all required configurations
- Configured HTTP server to listen on port from `PORT` env var (default 4000)
- Enabled CORS with origin 'http://localhost:3000' and credentials enabled (matching backend configuration)
- Configured raw body middleware for Stripe webhook endpoint at `/billing/webhook` using `express.raw({ type: 'application/json' })`
- Configured global ValidationPipe with transform, whitelist, and forbidNonWhitelisted options
- Set up Bull Board dashboard at `/admin/queues` for queue monitoring (copied from backend)
- Created `apps/api/src/bull-board.ts` helper file for Bull Board setup
- Removed placeholder `apps/api/src/index.ts` file
- Files changed:
  - `apps/api/src/main.ts` - Created with NestJS bootstrap configuration
  - `apps/api/src/bull-board.ts` - Created Bull Board setup helper
  - Deleted `apps/api/src/index.ts` - Removed placeholder file
- **Learnings for future iterations:**
  - API service main.ts follows same pattern as backend main.ts for consistency
  - Raw body middleware must be configured for webhook endpoints that need signature verification (e.g., Stripe)
  - NestFactory.create() with `rawBody: true` option enables raw body access throughout the app
  - Express middleware (`express.raw()`) can be applied to specific routes using `app.use()`
  - Bull Board dashboard is useful for monitoring queue jobs in development
  - CORS configuration should match frontend origin (http://localhost:3000)
  - Use `yarn workspace api typecheck`, `turbo run lint --filter=api`, and `turbo run build --filter=api` to verify main.ts configuration
  - API service can start successfully once database and Redis connections are configured
---

## 2026-01-18 15:40 - US-014
- Created worker service directory structure at `apps/worker/src/` with required subdirectories (processors, services)
- Directory structure mirrors the backend structure for easy migration of processors and services
- Files changed:
  - Created directory structure: `apps/worker/src/{processors,services}/`
- **Learnings for future iterations:**
  - Empty directories are not tracked by git until files are added (this is expected behavior)
  - Worker service directory structure mirrors backend structure to facilitate migration
  - Use `yarn lint` and `yarn build` to verify changes don't break existing code
  - Typecheck passes automatically when there are no TypeScript files to check
---

## 2026-01-19 - US-015
- Created `apps/worker/package.json` with NestJS dependencies including `@nestjs/schedule@^6.1.0` (version 6.x supports NestJS 11)
- Created `apps/worker/tsconfig.json` with TypeScript configuration including paths to shared package (`@subscriber-nest/shared` and `@subscriber-nest/shared/*`)
- Created `apps/worker/nest-cli.json` with NestJS CLI configuration
- Copied `apps/worker/eslint.config.mjs` from API service for linting configuration
- Created minimal `apps/worker/src/index.ts` placeholder file to allow typecheck to pass
- Root `package.json` already had `apps/*` in workspaces, so no update needed
- Files changed:
  - `apps/worker/package.json` - Created with NestJS dependencies including @nestjs/schedule
  - `apps/worker/tsconfig.json` - Created with TypeScript config and shared package paths
  - `apps/worker/nest-cli.json` - Created with NestJS CLI config
  - `apps/worker/eslint.config.mjs` - Copied from API service
  - `apps/worker/src/index.ts` - Created minimal placeholder
- **Learnings for future iterations:**
  - Use `@nestjs/schedule@^6.1.0` or later for NestJS 11 compatibility (version 4.x only supports NestJS 8-10)
  - Worker service package.json includes only essential dependencies (no HTTP-related packages like @nestjs/platform-express, @bull-board, axios, etc.)
  - TypeScript path aliases in tsconfig.json reference shared package using relative paths from tsconfig location
  - Copy eslint.config.mjs from API service to maintain consistent linting configuration
  - Root package.json workspaces already includes `apps/*`, so new apps are automatically recognized
  - Use `yarn install` after creating package.json to install dependencies
  - Use `turbo run lint --filter=worker`, `turbo run build --filter=worker`, and `yarn workspace worker typecheck` to verify worker service configuration
---

## 2026-01-19 - US-016
- Copied all 3 processor files from `apps/backend/src/processors/` to `apps/worker/src/processors/`:
  - subscriber-sync.processor.ts
  - billing.processor.ts
  - account-deletion.processor.ts
- All processors already use shared package imports (`@subscriber-nest/shared/entities`) - no updates needed
- Service imports point to `../services/` which is correct for worker service structure (services will be copied in US-017)
- Removed placeholder `apps/worker/src/index.ts` file
- Files changed:
  - Created `apps/worker/src/processors/subscriber-sync.processor.ts`
  - Created `apps/worker/src/processors/billing.processor.ts`
  - Created `apps/worker/src/processors/account-deletion.processor.ts`
  - Deleted `apps/worker/src/index.ts` placeholder file
- **Learnings for future iterations:**
  - Processors copied from backend already use shared package imports (from previous stories), so no import updates needed
  - Processors import services from `../services/` which will be copied in US-017
  - Type errors for missing services are expected until US-017 is completed (similar to how controllers had type errors until services were copied in US-009)
  - All entity imports correctly use `@subscriber-nest/shared/entities` paths
  - Use `turbo run lint --filter=worker` to verify code style after copying processors
  - Processors use `@InjectRepository` for TypeORM repositories, which will need to be configured in AppModule (US-018)
---

## 2026-01-18 15:45 - US-017
- Copied all 3 core worker services from `apps/backend/src/services/` to `apps/worker/src/services/`:
  - SubscriberSyncService
  - SubscriberMapperService
  - SyncHistoryService
- Copied BeehiivConnector from `apps/backend/src/connectors/` to `apps/worker/src/connectors/`
- Copied supporting files:
  - IEspConnector interface to `apps/worker/src/interfaces/`
  - esp.interface.ts to `apps/worker/src/interfaces/`
  - email.util.ts to `apps/worker/src/utils/`
- Copied dependent services needed by SubscriberSyncService:
  - SubscriberService
  - BillingUsageService (depends on BillingCalculationService and EspConnectionService)
  - BillingSubscriptionService
  - StripeService
  - BillingCalculationService
  - EspConnectionService
- All services already use shared package imports (`@subscriber-nest/shared/entities`, `@subscriber-nest/shared/dto`, `@subscriber-nest/shared/services`) - no updates needed
- Files changed:
  - Created 10 service files in `apps/worker/src/services/`
  - Created `apps/worker/src/connectors/beehiiv.connector.ts`
  - Created `apps/worker/src/interfaces/esp-connector.interface.ts` and `esp.interface.ts`
  - Created `apps/worker/src/utils/email.util.ts`
- **Learnings for future iterations:**
  - Services copied from backend already use shared package imports (from previous stories), so no import updates needed
  - When copying services, also copy their dependencies (e.g., SubscriberSyncService depends on SubscriberService, BillingUsageService, BillingSubscriptionService, StripeService)
  - BillingUsageService depends on BillingCalculationService and EspConnectionService, which also need to be copied
  - Worker service needs all services that SubscriberSyncService depends on, even if they're not explicitly listed in the PRD
  - All entity, DTO, and shared service imports correctly use `@subscriber-nest/shared/*` paths
  - Use `turbo run lint --filter=worker`, `turbo run build --filter=worker`, and `yarn workspace worker typecheck` to verify compilation and code style
  - Services use `@InjectRepository` for TypeORM repositories, which will need to be configured in AppModule (US-018)
---

## 2026-01-19 - US-018
- Created `apps/worker/src/app.module.ts` with TypeORM configuration matching API service structure
- Configured `TypeOrmModule.forRoot()` with database connection settings from environment variables (DATABASE_HOST, DATABASE_PORT, DATABASE_USER, DATABASE_PASSWORD, DATABASE_NAME)
- Configured `TypeOrmModule.forFeature()` with all 8 entities from shared package (Subscriber, EspConnection, VerificationCode, User, Session, SyncHistory, BillingSubscription, BillingUsage)
- Registered all 3 processors (SubscriberSyncProcessor, BillingProcessor, AccountDeletionProcessor)
- Registered all 9 services and dependencies (EncryptionService from shared package, BeehiivConnector, and all worker services)
- Configured ConfigModule.forRoot() for environment variable access
- Files changed:
  - `apps/worker/src/app.module.ts` - Created with TypeORM configuration
- **Learnings for future iterations:**
  - TypeORM configuration in worker service matches API service structure exactly (same connection settings, same entities)
  - All entities are imported from `@subscriber-nest/shared/entities` using named imports
  - TypeOrmModule.forFeature() must include all entities that will be used with @InjectRepository decorators in processors and services
  - ConfigModule.forRoot({ isGlobal: true }) allows all services to access environment variables via @nestjs/config
  - Worker service AppModule registers processors (which extend WorkerHost) as providers, not in imports
  - All processors and services must be registered in providers array for dependency injection to work
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify TypeORM configuration
  - TypeORM autoLoadEntities: true automatically discovers entities, but forFeature() is still needed for repository injection
---

## 2026-01-18 15:47 - US-019
- Configured BullMQ in worker service with `BullModule.forRoot()` using Redis connection from environment variables (REDIS_HOST, REDIS_PORT, REDIS_PASSWORD)
- Registered all three queues using `BullModule.registerQueue()` with retry configuration (3 attempts, exponential backoff with 2000ms delay): subscriber-sync, billing, and account-deletion
- All queue processors (SubscriberSyncProcessor, BillingProcessor, AccountDeletionProcessor) are already registered in AppModule providers from US-018
- Files changed:
  - `apps/worker/src/app.module.ts` - Added BullModule import and configuration
- **Learnings for future iterations:**
  - BullMQ configuration in worker service matches API service structure (same Redis connection settings, same queue names, same retry configuration)
  - Worker service needs both `BullModule.forRoot()` and `BullModule.registerQueue()` for each queue
  - Processors are registered in providers array (not imports) and use `@Processor('queue-name')` decorator
  - All three queues (subscriber-sync, billing, account-deletion) are registered with the same retry configuration (3 attempts, exponential backoff)
  - Redis connection uses environment variables with defaults (localhost:6379, no password)
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify BullMQ configuration
---

## 2026-01-19 - US-020
- Installed and configured NestJS Schedule module in worker service
- Added `ScheduleModule.forRoot()` import to `apps/worker/src/app.module.ts`
- Verified `@nestjs/schedule@^6.1.0` was already installed in `apps/worker/package.json` (from US-015)
- Schedule module is now properly initialized and ready for cron job decorators
- Files changed:
  - `apps/worker/src/app.module.ts` - Added ScheduleModule import and configuration
- **Learnings for future iterations:**
  - `@nestjs/schedule@^6.1.0` is already installed in worker service (installed in US-015)
  - `ScheduleModule.forRoot()` must be imported in AppModule imports array to enable cron decorators
  - Schedule module initialization is simple - just add `ScheduleModule.forRoot()` to imports
  - No additional configuration needed for basic cron job functionality
  - Use `yarn workspace worker typecheck` and `turbo run lint --filter=worker` to verify schedule module configuration
  - Schedule module enables `@Cron()` decorator for scheduling tasks in services
---

## 2026-01-19 - US-021
- Created `apps/worker/src/main.ts` that bootstraps NestJS application without HTTP server
- Worker service bootstraps the application and begins processing jobs from queues (subscriber-sync, billing, account-deletion)
- No `app.listen()` call - worker service doesn't need HTTP server, only processes jobs and runs cron jobs
- Added console logs to indicate worker service started successfully
- Files changed:
  - `apps/worker/src/main.ts` - Created with NestJS bootstrap configuration (no HTTP server)
- **Learnings for future iterations:**
  - Worker service main.ts is simpler than API service - no CORS, no raw body middleware, no validation pipes, no Bull Board
  - Worker service only needs `NestFactory.create(AppModule)` to bootstrap - no `app.listen()` call
  - Once bootstrapped, the worker service automatically starts processing jobs from registered queues and running cron jobs
  - Worker service doesn't need HTTP-related middleware or configuration
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify main.ts configuration
  - Worker service can start successfully once database and Redis connections are configured
---

## 2026-01-18 15:51 - US-022
- Created `SyncRequestedEvent` class in `packages/shared/src/events/sync-requested.event.ts` with `espConnectionId` and `userId` properties
- Event class uses constructor with readonly properties for immutability
- Exported event class from `packages/shared/src/events/index.ts`
- Main shared package index.ts already exports from events module, so event is available via `@subscriber-nest/shared/events`
- Files changed:
  - `packages/shared/src/events/sync-requested.event.ts` - Created event class
  - `packages/shared/src/events/index.ts` - Exported SyncRequestedEvent
- **Learnings for future iterations:**
  - NestJS event emitter events are plain TypeScript classes with properties
  - Event classes should use readonly properties and constructor parameters for immutability
  - Events in shared package can be imported via `@subscriber-nest/shared/events` path
  - Main shared package index.ts already exports all subdirectories, so events are automatically available
  - Use `yarn workspace @subscriber-nest/shared typecheck` and `turbo run build --filter=@subscriber-nest/shared` to verify event compilation
  - Event classes don't need any decorators or special configuration - just plain classes
---

## 2026-01-18 15:52 - US-023
- Installed `@nestjs/event-emitter@3.0.1` package in both `apps/api` and `apps/worker`
- Added `EventEmitterModule.forRoot()` import to API service AppModule
- Added `EventEmitterModule.forRoot()` import to worker service AppModule
- Event emitter module is now configured and ready for event-based communication between services
- Files changed:
  - `apps/api/package.json` - Added @nestjs/event-emitter dependency
  - `apps/worker/package.json` - Added @nestjs/event-emitter dependency
  - `apps/api/src/app.module.ts` - Added EventEmitterModule import and configuration
  - `apps/worker/src/app.module.ts` - Added EventEmitterModule import and configuration
- **Learnings for future iterations:**
  - `@nestjs/event-emitter@3.0.1` is compatible with NestJS 11 (peer dependency warnings are expected but don't affect functionality)
  - `EventEmitterModule.forRoot()` must be imported in AppModule imports array to enable event publishing and listening
  - Event emitter module initialization is simple - just add `EventEmitterModule.forRoot()` to imports (no additional configuration needed for basic usage)
  - Services can now use `EventEmitter2` (injected via constructor) to publish events and `@OnEvent()` decorator to listen to events
  - Use `yarn workspace api typecheck`, `yarn workspace worker typecheck`, `turbo run lint --filter=api --filter=worker`, and `turbo run build --filter=api --filter=worker` to verify event emitter configuration
---

## 2026-01-18 15:54 - US-024
- Updated `EspConnectionController.triggerSync()` to use event-based communication instead of direct queue job addition
- Injected `EventEmitter2` from `@nestjs/event-emitter` into controller constructor (replaced `@InjectQueue` and `subscriberSyncQueue`)
- Published `SyncRequestedEvent` with `espConnectionId` and `userId` when sync is triggered
- Removed direct queue job addition (`subscriberSyncQueue.add()`) from API controller
- Removed `jobId` from response type and body (no longer available since we're using events)
- API service still returns immediate 202 Accepted response with status, message, and connection
- Files changed:
  - `apps/api/src/controllers/esp-connection.controller.ts` - Updated imports, constructor, and triggerSync method
- **Learnings for future iterations:**
  - API service publishes events using `EventEmitter2.emit()` - events are published synchronously but processed asynchronously by listeners
  - Event emitter was already configured in API service AppModule from US-023, so no module configuration changes needed
  - When converting from direct queue jobs to events, remove `@InjectQueue` decorator and queue injection, replace with `EventEmitter2` injection
  - Event publishing doesn't return a job ID, so response structure may need to be adjusted (removed `jobId` field)
  - Use `eventEmitter.emit('EventClassName', eventInstance)` to publish events - event class name is used as the event name
  - Import event classes from `@subscriber-nest/shared/events` to use in controllers
  - API service now decoupled from queue implementation - worker service will handle queue job creation from events
  - Use `yarn workspace api typecheck`, `turbo run lint --filter=api`, and `turbo run build --filter=api` to verify changes
---

## 2026-01-18 15:55 - US-025
- Created `SyncEventListenerService` in `apps/worker/src/services/` that subscribes to `SyncRequestedEvent` using `@OnEvent('SyncRequestedEvent')` decorator
- Listener service injects `subscriber-sync` queue using `@InjectQueue('subscriber-sync')` and adds `sync-publication` job when event is received
- Listener logs received events with ESP connection ID and user ID
- Registered `SyncEventListenerService` in worker service AppModule providers
- Files changed:
  - `apps/worker/src/services/sync-event-listener.service.ts` - Created event listener service
  - `apps/worker/src/app.module.ts` - Added SyncEventListenerService import and registration
- **Learnings for future iterations:**
  - Event listeners in NestJS use `@OnEvent('EventClassName')` decorator to subscribe to events
  - Event listener services must be registered in AppModule providers for dependency injection to work
  - Use `@InjectQueue('queue-name')` from `@nestjs/bullmq` to inject queue instances in services
  - Queue type is `Queue` from `bullmq` package
  - Event listener methods receive the event instance as parameter (e.g., `handleSyncRequested(event: SyncRequestedEvent)`)
  - Event emitter module was already configured in worker service AppModule from US-023, so no module configuration changes needed
  - Use `queue.add('job-name', jobData)` to add jobs to BullMQ queues
  - Event listeners should log received events for debugging and monitoring
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify event listener implementation
---

## 2026-01-19 - US-026
- Created `SyncSchedulerService` in `apps/worker/src/services/` with midnight UTC cron job
- Used `@Cron('0 0 * * *', { timeZone: 'UTC' })` decorator for midnight UTC schedule
- Service queries database for all ESP connections where `status = EspConnectionStatus.ACTIVE` using TypeORM repository
- For each active connection, adds a `sync-publication` job to `subscriber-sync` queue using `subscriberSyncQueue.add()`
- Logs number of connections queued for sync (both successful and total count)
- Handles errors gracefully with try-catch blocks (logs errors but doesn't crash the scheduler)
- Service is registered in worker service AppModule providers
- Files changed:
  - `apps/worker/src/services/sync-scheduler.service.ts` - Created scheduler service
  - `apps/worker/src/app.module.ts` - Added SyncSchedulerService import and registration
- **Learnings for future iterations:**
  - Use `@InjectRepository(Entity)` to inject TypeORM repositories in services for database queries
  - Use `@InjectQueue('queue-name')` to inject BullMQ queue instances in services
  - `@Cron()` decorator from `@nestjs/schedule` requires `ScheduleModule.forRoot()` to be imported in AppModule (already done in US-020)
  - Cron jobs run automatically once the service is registered in AppModule providers - no manual initialization needed
  - Use `repository.find({ where: { status: EnumValue } })` to query entities by enum status
  - Handle errors at both the individual connection level (continue processing others) and the overall scheduler level (log but don't crash)
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify scheduler implementation
---

## 2026-01-18 15:59 - US-027
- Moved `BillingSchedulerService` from `apps/backend/src/services/` to `apps/worker/src/services/`
- Updated import path for `MonthlyBillingJobData` to reference worker processor (`../processors/billing.processor`)
- Registered `BillingSchedulerService` in worker service AppModule providers
- Removed `BillingSchedulerService` from backend AppModule (both import and provider registration)
- All imports already use shared package entities (no updates needed)
- Files changed:
  - Created `apps/worker/src/services/billing-scheduler.service.ts` - Copied from backend
  - Updated `apps/worker/src/app.module.ts` - Added BillingSchedulerService import and registration
  - Updated `apps/backend/src/app.module.ts` - Removed BillingSchedulerService import and registration
- **Learnings for future iterations:**
  - When moving scheduler services to worker, update import paths for processor types (e.g., `MonthlyBillingJobData`) to reference worker processor location
  - Scheduler services that use `OnModuleInit` to schedule BullMQ repeatable jobs can be moved to worker service without changes (they'll be converted to cron decorators in a later story)
  - Worker service already has all required dependencies (BullMQ, TypeORM) for scheduler services
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify service migration
  - Backend service still compiles correctly after removing scheduler service (verified with `turbo run build --filter=backend`)
---

## 2026-01-18 16:00 - US-028
- Converted `BillingSchedulerService` from BullMQ repeatable jobs to NestJS Schedule cron decorator
- Removed `OnModuleInit` interface and `onModuleInit()` method
- Removed BullMQ repeatable job scheduling logic (checking for existing jobs, scheduling with repeat pattern)
- Added `@Cron('0 0 1 * *', { timeZone: 'UTC' })` decorator to `runMonthlyBilling()` method
- Method runs on 1st day of each month at 00:00 UTC and directly adds job to billing queue
- Files changed:
  - `apps/worker/src/services/billing-scheduler.service.ts` - Converted to use cron decorator instead of OnModuleInit
- **Learnings for future iterations:**
  - Use `@Cron()` decorator from `@nestjs/schedule` instead of BullMQ repeatable jobs for simpler cron scheduling
  - Cron decorator methods should directly add jobs to queues (no need for repeatable job management)
  - Remove `OnModuleInit` interface when converting from repeatable jobs to cron decorators
  - Cron pattern `'0 0 1 * *'` runs on 1st day of month at 00:00 UTC (minute 0, hour 0, day 1, every month)
  - Error handling in cron methods should log errors but not crash (similar to SyncSchedulerService pattern)
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify cron conversion
---

## 2026-01-18 16:01 - US-029
- Moved `AccountDeletionSchedulerService` from `apps/backend/src/services/` to `apps/worker/src/services/`
- Updated import path for `AccountDeletionJobData` to reference worker processor (`../processors/account-deletion.processor`)
- Registered `AccountDeletionSchedulerService` in worker service AppModule providers
- Removed `AccountDeletionSchedulerService` from backend AppModule (both import and provider registration)
- All imports already use shared package entities (no updates needed)
- Files changed:
  - Created `apps/worker/src/services/account-deletion-scheduler.service.ts` - Copied from backend
  - Updated `apps/worker/src/app.module.ts` - Added AccountDeletionSchedulerService import and registration
  - Updated `apps/backend/src/app.module.ts` - Removed AccountDeletionSchedulerService import and registration
- **Learnings for future iterations:**
  - When moving scheduler services to worker, update import paths for processor types (e.g., `AccountDeletionJobData`) to reference worker processor location
  - Scheduler services that use `OnModuleInit` to schedule BullMQ repeatable jobs can be moved to worker service without changes (they'll be converted to cron decorators in a later story)
  - Worker service already has all required dependencies (BullMQ, TypeORM) for scheduler services
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify service migration
  - Backend service still compiles correctly after removing scheduler service (verified with `turbo run build --filter=backend`)
---

## 2026-01-19 - US-030
- Converted `AccountDeletionSchedulerService` from BullMQ repeatable jobs to NestJS Schedule cron decorator
- Removed `OnModuleInit` interface and `onModuleInit()` method
- Removed BullMQ repeatable job scheduling logic (checking for existing jobs, scheduling with repeat pattern)
- Added `@Cron('0 0 * * *', { timeZone: 'UTC' })` decorator to `runAccountDeletion()` method
- Method runs daily at 00:00 UTC and directly adds job to account-deletion queue
- Files changed:
  - `apps/worker/src/services/account-deletion-scheduler.service.ts` - Converted to use cron decorator instead of OnModuleInit
- **Learnings for future iterations:**
  - Use `@Cron()` decorator from `@nestjs/schedule` instead of BullMQ repeatable jobs for simpler cron scheduling
  - Cron decorator methods should directly add jobs to queues (no need for repeatable job management)
  - Remove `OnModuleInit` interface when converting from repeatable jobs to cron decorators
  - Cron pattern `'0 0 * * *'` runs daily at 00:00 UTC (minute 0, hour 0, every day)
  - Error handling in cron methods should log errors but not crash (similar to SyncSchedulerService and BillingSchedulerService patterns)
  - Use `yarn workspace worker typecheck`, `turbo run lint --filter=worker`, and `turbo run build --filter=worker` to verify cron conversion
---

## 2026-01-19 - US-031
- Verified Turbo configuration for new API and Worker services
- Confirmed that `turbo.json` already correctly applies tasks to all workspaces (Turborepo automatically discovers workspaces from `package.json`)
- Verified `turbo run build` builds both `api` and `worker` services successfully (along with shared package)
- Verified `turbo run dev` configuration supports running both services simultaneously (dev task is configured with `persistent: true` and `cache: false`)
- Verified typecheck passes for both services (`yarn workspace api typecheck` and `yarn workspace worker typecheck`)
- Verified lint passes for both services (`turbo run lint --filter=api --filter=worker`)
- Files changed:
  - No files changed (turbo.json was already correctly configured)
- **Learnings for future iterations:**
  - Turborepo automatically discovers all workspaces from `package.json` workspaces configuration (`apps/*` and `packages/*`)
  - Tasks defined in `turbo.json` apply to all workspaces automatically - no need to explicitly list apps
  - Use `turbo run build --filter=api --filter=worker` to build specific services
  - Use `turbo run dev --filter=api --filter=worker` to run multiple services simultaneously
  - Both `api` and `worker` services have all required scripts (build, dev, start, lint, typecheck) in their package.json files
  - Shared package (`@subscriber-nest/shared`) is automatically included in builds when it's a dependency
  - Use `yarn workspace <package-name> typecheck` to verify TypeScript compilation for individual packages
---

## 2026-01-18 16:05 - US-032
- Created `apps/api/.env.example` with API-specific environment variables (PORT, Stripe, Resend Email) and shared variables (DATABASE_*, REDIS_*, ENCRYPTION_KEY, NODE_ENV)
- Created `apps/worker/.env.example` with worker-specific environment variables (only shared variables, no service-specific ones)
- Documented which environment variables are shared between services (DATABASE_*, REDIS_*, ENCRYPTION_KEY, NODE_ENV) vs API-specific (PORT, STRIPE_*, RESEND_*)
- Both .env.example files include comments explaining which variables are shared vs service-specific
- Files changed:
  - `apps/api/.env.example` - Created with all API service environment variables
  - `apps/worker/.env.example` - Created with all worker service environment variables
- **Learnings for future iterations:**
  - API service requires additional environment variables for Stripe (STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET, STRIPE_METER_ID) and Resend email (RESEND_API_KEY, RESEND_FROM_EMAIL)
  - Worker service only needs shared environment variables (database, Redis, encryption, node env) - no service-specific variables
  - Both services share the same database and Redis connection settings
  - ENCRYPTION_KEY is required by EncryptionService (used by both services) and must be at least 32 characters
  - REDIS_PASSWORD is optional (can be empty string)
  - RESEND_FROM_EMAIL has a default value in EmailService, so it's optional in .env.example
  - Use `yarn workspace api typecheck`, `yarn workspace worker typecheck`, `turbo run lint`, and `turbo run build --filter=api --filter=worker` to verify changes
---

## 2026-01-19 - US-033
- Updated root README.md with new service structure (API and Worker services instead of monolithic backend)
- Documented how to run both services independently using `--filter` flag
- Added shared package documentation section explaining entities, DTOs, services, and events
- Updated environment variables section to include API and Worker service configurations
- Updated project structure section to show new directory layout with packages/shared
- Updated root AGENTS.md to reference API and Worker services instead of backend
- Created apps/api/AGENTS.md with API service-specific patterns and documentation
- Created apps/worker/AGENTS.md with worker service-specific patterns and documentation
- Files changed:
  - `README.md` - Updated with new service structure, environment variables, development commands, and shared package documentation
  - `AGENTS.md` - Updated to reference API and Worker services
  - `apps/api/AGENTS.md` - Created with API service documentation
  - `apps/worker/AGENTS.md` - Created with worker service documentation
- **Learnings for future iterations:**
  - Documentation should reflect the actual service architecture (API + Worker split)
  - Environment variables are shared between API and Worker (DATABASE_*, REDIS_*, ENCRYPTION_KEY) but some are service-specific (PORT, STRIPE_*, RESEND_* for API)
  - Use `--filter` flag with Turborepo commands to run services independently (e.g., `npm run dev --filter=api --filter=worker`)
  - Shared package documentation should explain how to import from it using `@subscriber-nest/shared/*` path aliases
  - AGENTS.md files should be created for each service to document service-specific patterns and conventions
  - API service acts as HTTP API with event publishers, Worker service processes jobs and runs cron jobs
  - Typecheck passes for all services after documentation updates
---

## 2026-01-19 - US-034
- Verified all 7 controllers are registered in API service AppModule: AppController, AuthController, EspConnectionController, SubscriberController, DashboardController, BillingController, AccountController
- Verified all 10 services are registered in API service AppModule: AppService, EncryptionService, BeehiivConnector, SubscriberService, SubscriberExportService, EspConnectionService, EmailService, AuthService, SyncHistoryService, StripeService, BillingCalculationService, BillingUsageService, BillingSubscriptionService
- Verified all controllers have proper route prefixes: `/` (AppController), `/auth` (AuthController), `/esp-connections` (EspConnectionController), `/subscribers` (SubscriberController), `/dashboard` (DashboardController), `/billing` (BillingController), `/account` (AccountController)
- Verified typecheck passes (`yarn workspace api typecheck`)
- Verified build passes (`turbo run build --filter=api`)
- Verified lint passes (`turbo run lint --filter=api`)
- Verified main.ts is correctly configured with CORS, validation pipes, raw body middleware for webhooks, and Bull Board dashboard
- Files changed:
  - No code changes (verification only)
- **Learnings for future iterations:**
  - API service has 7 controllers with 24+ HTTP endpoints covering auth, ESP connections, subscribers, dashboard, billing, and account management
  - All controllers use proper NestJS decorators (@Controller, @Get, @Post, etc.) with route prefixes
  - API service requires database (PostgreSQL) and Redis connections to actually start, but code structure is verified
  - All services are properly registered in AppModule providers array for dependency injection
  - Guards (AuthGuard, SubscriptionGuard) are registered as providers and used with @UseGuards decorator
  - TypeORM entities are registered via TypeOrmModule.forFeature() for repository injection
  - BullMQ queues are registered for job producers (subscriber-sync, billing, account-deletion)
  - EventEmitterModule is configured for event-based communication with worker service
  - Use `yarn workspace api typecheck`, `turbo run build --filter=api`, and `turbo run lint --filter=api` to verify API service
---

## 2026-01-19 - US-035
- Verified all 3 processors are registered in worker service AppModule: SubscriberSyncProcessor, BillingProcessor, AccountDeletionProcessor
- Verified all 3 queues are registered in worker service AppModule: subscriber-sync, billing, account-deletion
- Verified job names match between schedulers/listeners and processors:
  - SyncEventListenerService adds `sync-publication` jobs  SubscriberSyncProcessor expects `sync-publication` 
  - BillingSchedulerService adds `monthly-billing` jobs  BillingProcessor expects `monthly-billing` 
  - AccountDeletionSchedulerService adds `account-deletion` jobs  AccountDeletionProcessor expects `account-deletion` 
- Verified all processors extend WorkerHost and implement process() method correctly
- Verified typecheck passes (`yarn workspace worker typecheck`)
- Verified build passes (`turbo run build --filter=worker`)
- Verified lint passes (`turbo run lint --filter=worker`)
- Verified worker service main.ts bootstraps application correctly (no HTTP server, processes jobs and runs cron jobs)
- Files changed:
  - No code changes (verification only)
- **Learnings for future iterations:**
  - Worker service has 3 processors that handle jobs from 3 queues: subscriber-sync (sync-publication jobs), billing (monthly-billing jobs), account-deletion (account-deletion jobs)
  - All processors use `@Processor('queue-name')` decorator matching the queue name they process
  - Processors extend `WorkerHost` and implement `process(job: Job<JobData>)` method
  - Processors check `job.name` to verify job type matches expected type (e.g., `job.name !== "sync-publication"`)
  - All processors are registered in AppModule providers array for dependency injection
  - All queues are registered using `BullModule.registerQueue()` with retry configuration (3 attempts, exponential backoff)
  - Worker service requires database (PostgreSQL) and Redis connections to actually start, but code structure is verified
  - Job names must match exactly between schedulers/listeners (where jobs are added) and processors (where jobs are processed)
  - Use `yarn workspace worker typecheck`, `turbo run build --filter=worker`, and `turbo run lint --filter=worker` to verify worker service
---
